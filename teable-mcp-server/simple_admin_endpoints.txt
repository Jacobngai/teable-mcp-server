	// ============ SIMPLE ADMIN WHATSAPP API ENDPOINTS ============

	// Start admin WhatsApp connection (admin only)
	app.post('/api/admin/whatsapp/connect', requireAdmin, async (req: AdminRequest, res: Response) => {
		try {
			console.log(`[Admin WhatsApp] Connect request by admin: ${req.adminUser?.email}`);

			const result = await adminSessionManager.connect();
			
			if (result.success) {
				if (result.phone) {
					res.json({
						success: true,
						status: 'connected',
						data: { phone: result.phone },
						message: 'Admin WhatsApp already connected'
					});
				} else if (result.qrCode) {
					res.json({
						success: true,
						status: 'pending',
						data: { qrCode: result.qrCode },
						message: 'Scan QR code to connect admin WhatsApp'
					});
				} else {
					res.json({
						success: true,
						status: 'connecting',
						data: {},
						message: 'Connection in progress...'
					});
				}
			} else {
				res.status(400).json({ success: false, error: result.error || 'Failed to start connection' });
			}

		} catch (error) {
			console.error('[Admin WhatsApp] Connect error:', error);
			res.status(500).json({ success: false, error: 'Failed to connect admin WhatsApp' });
		}
	});

	// Get admin WhatsApp connection status (admin only)
	app.get('/api/admin/whatsapp/status', requireAdmin, async (req: AdminRequest, res: Response) => {
		try {
			const status = adminSessionManager.getStatus();

			res.json({
				success: true,
				data: {
					connected: status.connected,
					connecting: status.connecting,
					phone: status.phoneNumber,
					lastError: status.lastError,
					lastConnected: status.lastConnected,
					messagesSentToday: status.messagesSentToday,
					customerCount: status.customerCount
				}
			});
		} catch (error) {
			console.error('[Admin WhatsApp] Status error:', error);
			res.status(500).json({ success: false, error: 'Failed to get admin WhatsApp status' });
		}
	});

	// Get current admin QR code (admin only)
	app.get('/api/admin/whatsapp/qr', requireAdmin, async (req: AdminRequest, res: Response) => {
		try {
			const status = adminSessionManager.getStatus();

			if (status.connected) {
				res.json({ 
					success: true, 
					data: { status: 'connected', phone: status.phoneNumber } 
				});
			} else if (status.qrCode) {
				res.json({ 
					success: true, 
					data: { status: 'pending', qrCode: status.qrCode } 
				});
			} else if (status.connecting) {
				res.json({ 
					success: true, 
					data: { status: 'connecting' } 
				});
			} else {
				res.json({ 
					success: true, 
					data: { status: 'disconnected' } 
				});
			}
		} catch (error) {
			console.error('[Admin WhatsApp] QR error:', error);
			res.status(500).json({ success: false, error: 'Failed to get admin QR code' });
		}
	});

	// Disconnect admin WhatsApp (admin only)
	app.post('/api/admin/whatsapp/disconnect', requireAdmin, async (req: AdminRequest, res: Response) => {
		try {
			console.log(`[Admin WhatsApp] Disconnect request by admin: ${req.adminUser?.email}`);

			const result = await adminSessionManager.disconnect();
			
			if (result.success) {
				res.json({ success: true, message: 'Admin WhatsApp disconnected' });
			} else {
				res.status(400).json({ success: false, error: result.error || 'Failed to disconnect' });
			}

		} catch (error) {
			console.error('[Admin WhatsApp] Disconnect error:', error);
			res.status(500).json({ success: false, error: 'Failed to disconnect admin WhatsApp' });
		}
	});

	// Send admin test message (admin only)
	app.post('/api/admin/whatsapp/test', requireAdmin, async (req: AdminRequest, res: Response) => {
		try {
			const status = adminSessionManager.getStatus();
			
			if (!status.connected) {
				res.status(400).json({ success: false, error: 'Admin WhatsApp not connected' });
				return;
			}

			if (!status.phoneNumber) {
				res.status(400).json({ success: false, error: 'Admin phone number not available' });
				return;
			}

			console.log(`[Admin WhatsApp] Test message by admin: ${req.adminUser?.email}`);

			const testMessage = `Test message from Result Marketing Admin Dashboard\nTime: ${new Date().toLocaleString('en-MY')}`;
			const result = await adminSessionManager.sendMessage(status.phoneNumber, testMessage);

			if (result.success) {
				res.json({ 
					success: true, 
					message: 'Test message sent successfully',
					messageId: result.messageId
				});
			} else {
				res.status(400).json({ success: false, error: result.error || 'Failed to send test message' });
			}

		} catch (error) {
			console.error('[Admin WhatsApp] Test message error:', error);
			res.status(500).json({ success: false, error: 'Failed to send admin test message' });
		}
	});

	// Send message to customer phone (admin only)
	app.post('/api/admin/whatsapp/send', requireAdmin, async (req: AdminRequest, res: Response) => {
		try {
			const { phoneNumber, message } = req.body;

			if (!phoneNumber || !message) {
				res.status(400).json({ success: false, error: 'phoneNumber and message are required' });
				return;
			}

			const status = adminSessionManager.getStatus();
			
			if (!status.connected) {
				res.status(400).json({ success: false, error: 'Admin WhatsApp not connected' });
				return;
			}

			console.log(`[Admin WhatsApp] Send message by admin: ${req.adminUser?.email} to ${phoneNumber}`);

			const result = await adminSessionManager.sendMessage(phoneNumber, message);

			if (result.success) {
				res.json({ 
					success: true, 
					message: 'Message sent successfully',
					messageId: result.messageId
				});
			} else {
				res.status(400).json({ success: false, error: result.error || 'Failed to send message' });
			}

		} catch (error) {
			console.error('[Admin WhatsApp] Send message error:', error);
			res.status(500).json({ success: false, error: 'Failed to send message to customer' });
		}
	});